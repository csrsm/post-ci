<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>SpringBoot-原理解析 | Csrsm</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/post-ci/img/favicon.ico">
    <meta name="description" content="This is my blog">
    <link rel="preload" href="/post-ci/assets/css/0.styles.0012e2a3.css" as="style"><link rel="preload" href="/post-ci/assets/js/app.f434079f.js" as="script"><link rel="preload" href="/post-ci/assets/js/7.8eaaf042.js" as="script"><link rel="preload" href="/post-ci/assets/js/45.352ae01d.js" as="script"><link rel="prefetch" href="/post-ci/assets/js/1.2e718cca.js"><link rel="prefetch" href="/post-ci/assets/js/10.503da5e1.js"><link rel="prefetch" href="/post-ci/assets/js/11.9d2fdfae.js"><link rel="prefetch" href="/post-ci/assets/js/12.fcb21a1d.js"><link rel="prefetch" href="/post-ci/assets/js/13.96503fd7.js"><link rel="prefetch" href="/post-ci/assets/js/14.20d93468.js"><link rel="prefetch" href="/post-ci/assets/js/15.f0e991c0.js"><link rel="prefetch" href="/post-ci/assets/js/16.033ef5c4.js"><link rel="prefetch" href="/post-ci/assets/js/17.ad79235f.js"><link rel="prefetch" href="/post-ci/assets/js/18.0505af28.js"><link rel="prefetch" href="/post-ci/assets/js/19.70092390.js"><link rel="prefetch" href="/post-ci/assets/js/20.e393cae7.js"><link rel="prefetch" href="/post-ci/assets/js/21.0973e7c3.js"><link rel="prefetch" href="/post-ci/assets/js/22.3329f709.js"><link rel="prefetch" href="/post-ci/assets/js/23.1c2d7d48.js"><link rel="prefetch" href="/post-ci/assets/js/24.2bbbae87.js"><link rel="prefetch" href="/post-ci/assets/js/25.e2d55e6c.js"><link rel="prefetch" href="/post-ci/assets/js/26.4f4b6751.js"><link rel="prefetch" href="/post-ci/assets/js/27.e2ce2855.js"><link rel="prefetch" href="/post-ci/assets/js/28.33d7a492.js"><link rel="prefetch" href="/post-ci/assets/js/29.512128c3.js"><link rel="prefetch" href="/post-ci/assets/js/3.ff189134.js"><link rel="prefetch" href="/post-ci/assets/js/30.5336d253.js"><link rel="prefetch" href="/post-ci/assets/js/31.87b9a222.js"><link rel="prefetch" href="/post-ci/assets/js/32.b16f9ee5.js"><link rel="prefetch" href="/post-ci/assets/js/33.e4913f80.js"><link rel="prefetch" href="/post-ci/assets/js/34.b0fdd153.js"><link rel="prefetch" href="/post-ci/assets/js/35.f0994930.js"><link rel="prefetch" href="/post-ci/assets/js/36.ab339a1d.js"><link rel="prefetch" href="/post-ci/assets/js/37.bb5c491b.js"><link rel="prefetch" href="/post-ci/assets/js/38.7afe4939.js"><link rel="prefetch" href="/post-ci/assets/js/39.91db993c.js"><link rel="prefetch" href="/post-ci/assets/js/4.326ff035.js"><link rel="prefetch" href="/post-ci/assets/js/40.2ac40498.js"><link rel="prefetch" href="/post-ci/assets/js/41.9da85d02.js"><link rel="prefetch" href="/post-ci/assets/js/42.427d852c.js"><link rel="prefetch" href="/post-ci/assets/js/43.ff39cf08.js"><link rel="prefetch" href="/post-ci/assets/js/44.cba928a5.js"><link rel="prefetch" href="/post-ci/assets/js/46.f9d59464.js"><link rel="prefetch" href="/post-ci/assets/js/47.d35f6d84.js"><link rel="prefetch" href="/post-ci/assets/js/48.ef4a5f7b.js"><link rel="prefetch" href="/post-ci/assets/js/49.5d627a0e.js"><link rel="prefetch" href="/post-ci/assets/js/5.f96cd824.js"><link rel="prefetch" href="/post-ci/assets/js/50.fab4ccc6.js"><link rel="prefetch" href="/post-ci/assets/js/51.a1f72564.js"><link rel="prefetch" href="/post-ci/assets/js/52.552235e2.js"><link rel="prefetch" href="/post-ci/assets/js/53.0b60c227.js"><link rel="prefetch" href="/post-ci/assets/js/54.5a97decb.js"><link rel="prefetch" href="/post-ci/assets/js/55.517779f4.js"><link rel="prefetch" href="/post-ci/assets/js/56.2bcb7b9d.js"><link rel="prefetch" href="/post-ci/assets/js/57.da623f96.js"><link rel="prefetch" href="/post-ci/assets/js/58.1c36665a.js"><link rel="prefetch" href="/post-ci/assets/js/59.f0ec58cd.js"><link rel="prefetch" href="/post-ci/assets/js/6.562b2ef1.js"><link rel="prefetch" href="/post-ci/assets/js/60.c4b35501.js"><link rel="prefetch" href="/post-ci/assets/js/8.40f58b51.js"><link rel="prefetch" href="/post-ci/assets/js/9.c8fcfbba.js">
    <link rel="stylesheet" href="/post-ci/assets/css/0.styles.0012e2a3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-meteorlxy"><header class="header" style="background-size:cover;background-repeat:no-repeat;background-position:center;background-attachment:scroll;background-image:url(http://img.icoisini.xyz/background.jpg);" data-v-7a046aea><div data-v-e4145d0a data-v-7a046aea><nav class="navbar" data-v-e4145d0a><div class="container" data-v-e4145d0a><a href="/post-ci/" class="router-link-active" data-v-e4145d0a><span class="navbar-site-name" data-v-e4145d0a>
          Csrsm
        </span></a> <div class="navbar-toggler" data-v-e4145d0a><svg class="icon" style="font-size:1.2em;" data-v-e4145d0a data-v-e4145d0a><title data-v-e4145d0a data-v-e4145d0a>menu</title><use xlink:href="#icon-menu" data-v-e4145d0a data-v-e4145d0a></use></svg></div> <div class="navbar-links" data-v-e4145d0a><a href="/post-ci/" class="navbar-link" data-v-e4145d0a>
            首页
          </a><a href="/post-ci/posts/" class="navbar-link router-link-active" data-v-e4145d0a>
            Csrsm
          </a></div></div></nav> <div class="navbar-holder" style="display:none;" data-v-e4145d0a></div></div> <div class="banner" data-v-98d6aa8c data-v-7a046aea data-v-7a046aea><div class="container" data-v-98d6aa8c><div class="center" data-v-98d6aa8c><h1 data-v-98d6aa8c data-v-7a046aea>
          SpringBoot-原理解析
        </h1></div></div></div></header> <div class="container clearfix show-aside" data-v-4dd605a1 data-v-4dd605a1><main class="main" data-v-4dd605a1><div class="post" data-v-4dd605a1 data-v-4dd605a1><section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      发布时间 : 2020-01-21
    </span> <span class="update-date" data-v-4e23451f>
      最后修改 : 2024-12-12
    </span></section> <section class="post-links" data-v-4e23451f><a href="/post-ci/posts/2020/01/21/springboot2-%E6%8C%87%E6%A0%87%E7%9B%91%E6%8E%A7.html" class="post-link" data-v-4e23451f>
      上一篇 : SpringBoot-指标监控
    </a> <a href="/post-ci/posts/2020/01/21/springboot2-test.html" class="post-link" data-v-4e23451f>
      下一篇 : SpringBoot-单元测试
    </a></section></section> <article class="main-div"><div class="post-content content content__default"><p>原理解析</p> <h1 id="springboot2核心技术-原理解析"><a href="#springboot2核心技术-原理解析" class="header-anchor">#</a> SpringBoot2核心技术-原理解析</h1> <h1 id="原理解析"><a href="#原理解析" class="header-anchor">#</a> 原理解析</h1> <h1 id="_1、profile功能"><a href="#_1、profile功能" class="header-anchor">#</a> 1、Profile功能</h1> <p>为了方便多环境适配，springboot简化了profile功能。</p> <h2 id="_1、application-profile功能"><a href="#_1、application-profile功能" class="header-anchor">#</a> 1、application-profile功能</h2> <ul><li><p>默认配置文件  application.yaml；任何时候都会加载</p></li> <li><p>指定环境配置文件  application-{env}.yaml</p></li> <li><p>激活指定环境</p></li> <li><ul><li>配置文件激活</li> <li>命令行激活：java -jar xxx.jar --<strong>spring.profiles.active=prod  --person.name=haha</strong></li></ul></li> <li><ul><li><ul><li><strong>修改配置文件的任意值，命令行优先</strong></li></ul></li></ul></li> <li><p>默认配置与环境配置同时生效</p></li> <li><p>同名配置项，profile配置优先</p></li></ul> <h2 id="_2、-profile条件装配功能"><a href="#_2、-profile条件装配功能" class="header-anchor">#</a> 2、@Profile条件装配功能</h2> <div class="language- extra-class"><pre class="language-text"><code>@Configuration(proxyBeanMethods = false)
@Profile(&quot;production&quot;)
public class ProductionConfiguration {
    // ...
}
</code></pre></div><h2 id="_3、profile分组"><a href="#_3、profile分组" class="header-anchor">#</a> 3、profile分组</h2> <div class="language- extra-class"><pre class="language-text"><code>spring.profiles.group.production[0]=proddb
spring.profiles.group.production[1]=prodmq
使用：--spring.profiles.active=production  激活
</code></pre></div><h1 id="_2、外部化配置"><a href="#_2、外部化配置" class="header-anchor">#</a> 2、外部化配置</h1> <p><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/spring-boot-features.html#boot-features-external-config" target="_blank" rel="noopener noreferrer">https://docs.spring.io/spring-boot/docs/current/reference/html/spring-boot-features.html#boot-features-external-config<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id=""><a href="#" class="header-anchor">#</a></h2> <ol><li>Default properties (specified by setting <code>SpringApplication.setDefaultProperties</code>).</li> <li><a href="https://docs.spring.io/spring/docs/5.3.1/javadoc-api/org/springframework/context/annotation/PropertySource.html" target="_blank" rel="noopener noreferrer"><code>@PropertySource</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> annotations on your <code>@Configuration</code> classes. Please note that such property sources are not added to the <code>Environment</code> until the application context is being refreshed. This is too late to configure certain properties such as <code>logging.*</code> and <code>spring.main.*</code> which are read before refresh begins.</li> <li><strong>Config data (such as</strong> <strong>application.properties</strong> <strong>files)</strong></li> <li>A <code>RandomValuePropertySource</code> that has properties only in <code>random.*</code>.</li> <li>OS environment variables.</li> <li>Java System properties (<code>System.getProperties()</code>).</li> <li>JNDI attributes from <code>java:comp/env</code>.</li> <li><code>ServletContext</code> init parameters.</li> <li><code>ServletConfig</code> init parameters.</li> <li>Properties from <code>SPRING_APPLICATION_JSON</code> (inline JSON embedded in an environment variable or system property).</li> <li>Command line arguments.</li> <li><code>properties</code> attribute on your tests. Available on <a href="https://docs.spring.io/spring-boot/docs/2.4.0/api/org/springframework/boot/test/context/SpringBootTest.html" target="_blank" rel="noopener noreferrer"><code>@SpringBootTest</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> and the <a href="https://docs.spring.io/spring-boot/docs/current/reference/html/spring-boot-features.html#boot-features-testing-spring-boot-applications-testing-autoconfigured-tests" target="_blank" rel="noopener noreferrer">test annotations for testing a particular slice of your application<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</li> <li><a href="https://docs.spring.io/spring/docs/5.3.1/javadoc-api/org/springframework/test/context/TestPropertySource.html" target="_blank" rel="noopener noreferrer"><code>@TestPropertySource</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> annotations on your tests.</li> <li><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/using-spring-boot.html#using-boot-devtools-globalsettings" target="_blank" rel="noopener noreferrer">Devtools global settings properties<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> in the <code>$HOME/.config/spring-boot</code> directory when devtools is active.</li></ol> <h2 id="_1、外部配置源"><a href="#_1、外部配置源" class="header-anchor">#</a> 1、外部配置源</h2> <p>常用：<strong>Java属性文件</strong>、<strong>YAML文件</strong>、<strong>环境变量</strong>、<strong>命令行参数</strong>；</p> <h2 id="_2、配置文件查找位置"><a href="#_2、配置文件查找位置" class="header-anchor">#</a> 2、配置文件查找位置</h2> <p>(1) classpath 根路径</p> <p>(2) classpath 根路径下config目录</p> <p>(3) jar包当前目录</p> <p>(4) jar包当前目录的config目录</p> <p>(5) /config子目录的直接子目录</p> <h2 id="_3、配置文件加载顺序"><a href="#_3、配置文件加载顺序" class="header-anchor">#</a> 3、配置文件加载顺序：</h2> <ol><li>当前jar包内部的application.properties和application.yml</li> <li>当前jar包内部的application-{profile}.properties 和 application-{profile}.yml</li> <li>引用的外部jar包的application.properties和application.yml</li> <li>引用的外部jar包的application-{profile}.properties 和 application-{profile}.yml</li></ol> <h2 id="_4、指定环境优先-外部优先-后面的可以覆盖前面的同名配置项"><a href="#_4、指定环境优先-外部优先-后面的可以覆盖前面的同名配置项" class="header-anchor">#</a> 4、指定环境优先，外部优先，后面的可以覆盖前面的同名配置项</h2> <h1 id="_3、自定义starter"><a href="#_3、自定义starter" class="header-anchor">#</a> 3、自定义starter</h1> <h2 id="_1、starter启动原理"><a href="#_1、starter启动原理" class="header-anchor">#</a> 1、starter启动原理</h2> <ul><li>starter-pom引入 autoconfigurer 包</li></ul> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1354552/1606995919308-b2c7ccaa-e720-4cc5-9801-2e170b3102e1.png" alt="img"></p> <ul><li><p>autoconfigure包中配置使用 <strong>META-INF/spring.factories</strong> 中 <strong>EnableAutoConfiguration 的值，使得项目启动加载指定的自动配置类</strong></p></li> <li><p><strong>编写自动配置类 xxxAutoConfiguration -&gt; xxxxProperties</strong></p></li> <li><ul><li><strong>@Configuration</strong></li> <li><strong>@Conditional</strong></li> <li><strong>@EnableConfigurationProperties</strong></li> <li><strong>@Bean</strong></li> <li>......</li></ul></li></ul> <p><strong>引入starter</strong> <strong>--- xxxAutoConfiguration --- 容器中放入组件 ---- 绑定xxxProperties ----</strong> <strong>配置项</strong></p> <h2 id="_2、自定义starter"><a href="#_2、自定义starter" class="header-anchor">#</a> 2、自定义starter</h2> <p><strong>atguigu-hello-spring-boot-starter（启动器）</strong></p> <p><strong>atguigu-hello-spring-boot-starter-autoconfigure（自动配置包）</strong></p> <h1 id="_4、springboot原理"><a href="#_4、springboot原理" class="header-anchor">#</a> 4、SpringBoot原理</h1> <p>Spring原理【<a href="https://www.bilibili.com/video/BV1gW411W7wy?p=1" target="_blank" rel="noopener noreferrer">Spring注解<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>】、<strong>SpringMVC</strong>原理、<strong>自动配置原理</strong>、SpringBoot原理</p> <h2 id="_1、springboot启动过程"><a href="#_1、springboot启动过程" class="header-anchor">#</a> 1、SpringBoot启动过程</h2> <ul><li><p>创建 <strong>SpringApplication</strong></p></li> <li><ul><li>保存一些信息。</li> <li>判定当前应用的类型。ClassUtils。Servlet</li> <li><strong>bootstrappers</strong>**：初始启动引导器（<strong>List<Bootstrapper></Bootstrapper></strong>）：去spring.factories文件中找** org.springframework.boot.<strong>Bootstrapper</strong></li> <li>找 <strong>ApplicationContextInitializer</strong>；去<strong>spring.factories****找</strong> <strong>ApplicationContextInitializer</strong></li></ul></li> <li><ul><li><ul><li>List&lt;ApplicationContextInitializer&lt;?&gt;&gt; <strong>initializers</strong></li></ul></li></ul></li> <li><ul><li><strong>找</strong> <strong>ApplicationListener  ；应用监听器。<strong>去</strong>spring.factories****找</strong> <strong>ApplicationListener</strong></li></ul></li> <li><ul><li><ul><li>List&lt;ApplicationListener&lt;?&gt;&gt; <strong>listeners</strong></li></ul></li></ul></li> <li><p>运行 <strong>SpringApplication</strong></p></li> <li><ul><li><strong>StopWatch</strong></li> <li><strong>记录应用的启动时间</strong></li> <li>**创建引导上下文（Context环境）**<strong>createBootstrapContext()</strong></li></ul></li> <li><ul><li><ul><li>获取到所有之前的 <strong>bootstrappers 挨个执行</strong> intitialize() 来完成对引导启动器上下文环境设置</li></ul></li></ul></li> <li><ul><li>让当前应用进入<strong>headless</strong>模式。<strong>java.awt.headless</strong></li> <li><strong>获取所有</strong> <strong>RunListener</strong>**（运行监听器）【为了方便所有Listener进行事件感知】**</li></ul></li> <li><ul><li><ul><li>getSpringFactoriesInstances 去<strong>spring.factories****找</strong> <strong>SpringApplicationRunListener</strong>.</li></ul></li></ul></li> <li><ul><li>遍历 <strong>SpringApplicationRunListener 调用 starting 方法；</strong></li></ul></li> <li><ul><li><ul><li><strong>相当于通知所有感兴趣系统正在启动过程的人，项目正在 starting。</strong></li></ul></li></ul></li> <li><ul><li>保存命令行参数；ApplicationArguments</li> <li>准备环境 prepareEnvironment（）;</li></ul></li> <li><ul><li><ul><li>返回或者创建基础环境信息对象。<strong>StandardServletEnvironment</strong></li> <li><strong>配置环境信息对象。</strong></li></ul></li></ul></li> <li><ul><li><ul><li><ul><li><strong>读取所有的配置源的配置属性值。</strong></li></ul></li></ul></li></ul></li> <li><ul><li><ul><li>绑定环境信息</li> <li>监听器调用 listener.environmentPrepared()；通知所有的监听器当前环境准备完成</li></ul></li></ul></li> <li><ul><li>创建IOC容器（createApplicationContext（））</li></ul></li> <li><ul><li><ul><li>根据项目类型（Servlet）创建容器，</li> <li>当前会创建 <strong>AnnotationConfigServletWebServerApplicationContext</strong></li></ul></li></ul></li> <li><ul><li><strong>准备ApplicationContext IOC容器的基本信息</strong> <strong>prepareContext()</strong></li></ul></li> <li><ul><li><ul><li>保存环境信息</li> <li>IOC容器的后置处理流程。</li> <li>应用初始化器；applyInitializers；</li></ul></li></ul></li> <li><ul><li><ul><li><ul><li>遍历所有的 <strong>ApplicationContextInitializer 。调用</strong> <strong>initialize.。来对ioc容器进行初始化扩展功能</strong></li> <li>遍历所有的 listener 调用 <strong>contextPrepared。EventPublishRunListenr；通知所有的监听器contextPrepared</strong></li></ul></li></ul></li></ul></li> <li><ul><li><ul><li><strong>所有的监听器 调用</strong> <strong>contextLoaded。通知所有的监听器 contextLoaded；</strong></li></ul></li></ul></li> <li><ul><li>**刷新IOC容器。**refreshContext</li></ul></li> <li><ul><li><ul><li>创建容器中的所有组件（Spring注解）</li></ul></li></ul></li> <li><ul><li>容器刷新完成后工作？afterRefresh</li> <li>所有监听 器 调用 listeners.<strong>started</strong>(context); <strong>通知所有的监听器</strong> <strong>started</strong></li> <li>**调用所有runners；**callRunners()</li></ul></li> <li><ul><li><ul><li><strong>获取容器中的</strong> <strong>ApplicationRunner</strong></li> <li><strong>获取容器中的</strong> <strong>CommandLineRunner</strong></li> <li><strong>合并所有runner并且按照@Order进行排序</strong></li> <li><strong>遍历所有的runner。调用 run</strong> <strong>方法</strong></li></ul></li></ul></li> <li><ul><li><strong>如果以上有异常，</strong></li></ul></li> <li><ul><li><ul><li><strong>调用Listener 的 failed</strong></li></ul></li></ul></li> <li><ul><li><strong>调用所有监听器的 running 方法</strong>  listeners.running(context); <strong>通知所有的监听器</strong> <strong>running</strong></li> <li>**running如果有问题。继续通知 failed 。**<strong>调用所有 Listener 的</strong> **failed；**<strong>通知所有的监听器</strong> <strong>failed</strong></li></ul></li></ul> <div class="language- extra-class"><pre class="language-text"><code>public interface Bootstrapper {
    /**
     * Initialize the given {@link BootstrapRegistry} with any required registrations.
     * @param registry the registry to initialize
     */
    void intitialize(BootstrapRegistry registry);
}
</code></pre></div><p><img src="https://cdn.nlark.com/yuque/0/2020/png/1354552/1607005958877-bf152e3e-4d2d-42b6-a08c-ceef9870f3b6.png" alt="image.png"></p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1354552/1607004823889-8373cea4-6305-40c1-af3b-921b071a28a8.png?x-oss-process=image%2Fwatermark%2Ctype_d3F5LW1pY3JvaGVp%2Csize_10%2Ctext_YXRndWlndS5jb20g5bCa56GF6LC3%2Ccolor_FFFFFF%2Cshadow_50%2Ct_80%2Cg_se%2Cx_10%2Cy_10" alt="image.png"></p> <p><img src="https://cdn.nlark.com/yuque/0/2020/png/1354552/1607006112013-6ed5c0a0-3e02-4bf1-bdb7-423e0a0b3f3c.png" alt="image.png"></p> <div class="language- extra-class"><pre class="language-text"><code>@FunctionalInterface
public interface ApplicationRunner {
    /**
     * Callback used to run the bean.
     * @param args incoming application arguments
     * @throws Exception on error
     */
    void run(ApplicationArguments args) throws Exception;
}
</code></pre></div><div class="language- extra-class"><pre class="language-text"><code>@FunctionalInterface
public interface CommandLineRunner {
    /**
     * Callback used to run the bean.
     * @param args incoming main method arguments
     * @throws Exception on error
     */
    void run(String... args) throws Exception;
}
</code></pre></div><h2 id="-2"><a href="#-2" class="header-anchor">#</a></h2> <h2 id="_2、application-events-and-listeners"><a href="#_2、application-events-and-listeners" class="header-anchor">#</a> 2、Application Events and Listeners</h2> <p><a href="https://docs.spring.io/spring-boot/docs/current/reference/html/spring-boot-features.html#boot-features-application-events-and-listeners" target="_blank" rel="noopener noreferrer">https://docs.spring.io/spring-boot/docs/current/reference/html/spring-boot-features.html#boot-features-application-events-and-listeners<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>ApplicationContextInitializer</strong></p> <p><strong>ApplicationListener</strong></p> <p><strong>SpringApplicationRunListener</strong></p> <h2 id="_3、applicationrunner-与-commandlinerunner"><a href="#_3、applicationrunner-与-commandlinerunner" class="header-anchor">#</a> 3、ApplicationRunner 与 CommandLineRunner</h2></div></article> <section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      发布时间 : 2020-01-21
    </span> <span class="update-date" data-v-4e23451f>
      最后修改 : 2024-12-12
    </span></section> <section class="post-links" data-v-4e23451f><a href="/post-ci/posts/2020/01/21/springboot2-%E6%8C%87%E6%A0%87%E7%9B%91%E6%8E%A7.html" class="post-link" data-v-4e23451f>
      上一篇 : SpringBoot-指标监控
    </a> <a href="/post-ci/posts/2020/01/21/springboot2-test.html" class="post-link" data-v-4e23451f>
      下一篇 : SpringBoot-单元测试
    </a></section></section> <div id="post-comments" class="main-div"><!----></div></div></main> <aside class="aside" data-v-4dd605a1><div class="info-card main-div" data-v-9d847660 data-v-4dd605a1><div class="info-card-header" style="background-size:cover;background-repeat:no-repeat;background-position:center;background-attachment:scroll;background-image:url(/img/wx-background.jpg);" data-v-9d847660><img src="/img/cm.jpg" alt="小二哥" class="info-avatar" data-v-9d847660></div> <div class="info-card-body" data-v-9d847660><section class="info-nickname" data-v-9d847660>
      小二哥
    </section> <section class="info-desc" data-v-9d847660>Don`t Worry Be Happy!</section> <section class="info-contact" data-v-9d847660><section data-v-9d847660><span title="DaLian City, China" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>DaLian City, China</title><use xlink:href="#icon-location" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          DaLian City, China
        </span></span></section> <section data-v-9d847660><span title="DaLian University of Technology" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>DaLian University of Technology</title><use xlink:href="#icon-organization" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          DaLian University of Technology
        </span></span></section> <section data-v-9d847660><a href="mailto:csrsming@163.com" title="csrsming@163.com" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>csrsming@163.com</title><use xlink:href="#icon-email" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          csrsming@163.com
        </span></a></section></section></div> <div class="info-card-footer" data-v-9d847660><section class="info-sns clearfix" data-v-9d847660><a href="https://github.com/csrsm" target="_blank" class="sns-link" data-v-9d847660><span title="GitHub: csrsm" class="sns-icon" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1.5em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>GitHub: csrsm</title><use xlink:href="#icon-github" data-v-9d847660 data-v-9d847660></use></svg></span></a></section></div></div> <div class="post-nav-card main-div" style="position:relative;top:0;width:0px;" data-v-4dd605a1><div class="post-nav-contents"><svg class="icon"><title>book</title><use xlink:href="#icon-book"></use></svg> <span>文章目录</span> <div class="post-nav-toc"><ul><li><a href="/post-ci/posts/2020/01/21/springboot2-%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90.html#_1、application-profile功能">1、application-profile功能</a></li><li><a href="/post-ci/posts/2020/01/21/springboot2-%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90.html#_2、-profile条件装配功能">2、@Profile条件装配功能</a></li><li><a href="/post-ci/posts/2020/01/21/springboot2-%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90.html#_3、profile分组">3、profile分组</a></li><li><a href="/post-ci/posts/2020/01/21/springboot2-%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90.html#"></a></li><li><a href="/post-ci/posts/2020/01/21/springboot2-%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90.html#_1、外部配置源">1、外部配置源</a></li><li><a href="/post-ci/posts/2020/01/21/springboot2-%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90.html#_2、配置文件查找位置">2、配置文件查找位置</a></li><li><a href="/post-ci/posts/2020/01/21/springboot2-%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90.html#_3、配置文件加载顺序">3、配置文件加载顺序：</a></li><li><a href="/post-ci/posts/2020/01/21/springboot2-%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90.html#_4、指定环境优先-外部优先-后面的可以覆盖前面的同名配置项">4、指定环境优先，外部优先，后面的可以覆盖前面的同名配置项</a></li><li><a href="/post-ci/posts/2020/01/21/springboot2-%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90.html#_1、starter启动原理">1、starter启动原理</a></li><li><a href="/post-ci/posts/2020/01/21/springboot2-%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90.html#_2、自定义starter">2、自定义starter</a></li><li><a href="/post-ci/posts/2020/01/21/springboot2-%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90.html#_1、springboot启动过程">1、SpringBoot启动过程</a></li><li><a href="/post-ci/posts/2020/01/21/springboot2-%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90.html#-2"></a></li><li><a href="/post-ci/posts/2020/01/21/springboot2-%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90.html#_2、application-events-and-listeners">2、Application Events and Listeners</a></li><li><a href="/post-ci/posts/2020/01/21/springboot2-%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90.html#_3、applicationrunner-与-commandlinerunner">3、ApplicationRunner 与 CommandLineRunner</a></li></ul></div></div> <div class="post-nav-comments"><svg class="icon"><title>comment</title><use xlink:href="#icon-comment"></use></svg> <a href="/post-ci/posts/2020/01/21/springboot2-%E5%8E%9F%E7%90%86%E8%A7%A3%E6%9E%90.html#post-comments">
      评论
    </a></div></div></aside></div> <footer class="footer" data-v-1375e54c><p class="footer-sns-links" data-v-1375e54c><a href="https://github.com/csrsm" target="_blank" class="sns-link" data-v-1375e54c><span title="GitHub: csrsm" class="sns-icon" data-v-1375e54c data-v-1375e54c><svg class="icon" style="font-size:25px;" data-v-1375e54c data-v-1375e54c><title data-v-1375e54c data-v-1375e54c>GitHub: csrsm</title><use xlink:href="#icon-github" data-v-1375e54c data-v-1375e54c></use></svg></span></a></p> <!----> <p class="footer-text" data-v-1375e54c>Copyright 2016-present <a href="https://github.com/csrsm" target="_blank">csrsm</a></p></footer></div><div class="global-ui"><!----><!----></div></div>
    <script src="/post-ci/assets/js/app.f434079f.js" defer></script><script src="/post-ci/assets/js/7.8eaaf042.js" defer></script><script src="/post-ci/assets/js/45.352ae01d.js" defer></script>
  </body>
</html>
