<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue | Csrsm</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/post-ci/favicon.ico">
    <meta name="description" content="This is my blog">
    <link rel="preload" href="/post-ci/assets/css/0.styles.0012e2a3.css" as="style"><link rel="preload" href="/post-ci/assets/js/app.2051f0b8.js" as="script"><link rel="preload" href="/post-ci/assets/js/7.8eaaf042.js" as="script"><link rel="preload" href="/post-ci/assets/js/50.186a336f.js" as="script"><link rel="prefetch" href="/post-ci/assets/js/1.a566e589.js"><link rel="prefetch" href="/post-ci/assets/js/10.503da5e1.js"><link rel="prefetch" href="/post-ci/assets/js/11.9d2fdfae.js"><link rel="prefetch" href="/post-ci/assets/js/12.fcb21a1d.js"><link rel="prefetch" href="/post-ci/assets/js/13.96503fd7.js"><link rel="prefetch" href="/post-ci/assets/js/14.20d93468.js"><link rel="prefetch" href="/post-ci/assets/js/15.64bd5037.js"><link rel="prefetch" href="/post-ci/assets/js/16.b9a58e29.js"><link rel="prefetch" href="/post-ci/assets/js/17.d4868fcd.js"><link rel="prefetch" href="/post-ci/assets/js/18.e106ea76.js"><link rel="prefetch" href="/post-ci/assets/js/19.ebf1a903.js"><link rel="prefetch" href="/post-ci/assets/js/20.0e2eae33.js"><link rel="prefetch" href="/post-ci/assets/js/21.4752cac2.js"><link rel="prefetch" href="/post-ci/assets/js/22.0a18be31.js"><link rel="prefetch" href="/post-ci/assets/js/23.000382ea.js"><link rel="prefetch" href="/post-ci/assets/js/24.db68ac55.js"><link rel="prefetch" href="/post-ci/assets/js/25.431855c5.js"><link rel="prefetch" href="/post-ci/assets/js/26.dd3da43c.js"><link rel="prefetch" href="/post-ci/assets/js/27.64c1a036.js"><link rel="prefetch" href="/post-ci/assets/js/28.87cb6b0a.js"><link rel="prefetch" href="/post-ci/assets/js/29.a985dc98.js"><link rel="prefetch" href="/post-ci/assets/js/3.ff189134.js"><link rel="prefetch" href="/post-ci/assets/js/30.1ebe5aff.js"><link rel="prefetch" href="/post-ci/assets/js/31.b371235e.js"><link rel="prefetch" href="/post-ci/assets/js/32.a1231124.js"><link rel="prefetch" href="/post-ci/assets/js/33.d558d933.js"><link rel="prefetch" href="/post-ci/assets/js/34.d7d644b4.js"><link rel="prefetch" href="/post-ci/assets/js/35.eb22c3ab.js"><link rel="prefetch" href="/post-ci/assets/js/36.bed5cd89.js"><link rel="prefetch" href="/post-ci/assets/js/37.f8911c28.js"><link rel="prefetch" href="/post-ci/assets/js/38.1ff48400.js"><link rel="prefetch" href="/post-ci/assets/js/39.c6f256ac.js"><link rel="prefetch" href="/post-ci/assets/js/4.326ff035.js"><link rel="prefetch" href="/post-ci/assets/js/40.55598602.js"><link rel="prefetch" href="/post-ci/assets/js/41.41fb4af9.js"><link rel="prefetch" href="/post-ci/assets/js/42.9fd7723b.js"><link rel="prefetch" href="/post-ci/assets/js/43.88e37717.js"><link rel="prefetch" href="/post-ci/assets/js/44.2a443682.js"><link rel="prefetch" href="/post-ci/assets/js/45.377399cb.js"><link rel="prefetch" href="/post-ci/assets/js/46.a5414bf6.js"><link rel="prefetch" href="/post-ci/assets/js/47.a43294de.js"><link rel="prefetch" href="/post-ci/assets/js/48.8742461a.js"><link rel="prefetch" href="/post-ci/assets/js/49.b778b074.js"><link rel="prefetch" href="/post-ci/assets/js/5.f96cd824.js"><link rel="prefetch" href="/post-ci/assets/js/6.562b2ef1.js"><link rel="prefetch" href="/post-ci/assets/js/8.40f58b51.js"><link rel="prefetch" href="/post-ci/assets/js/9.c8fcfbba.js">
    <link rel="stylesheet" href="/post-ci/assets/css/0.styles.0012e2a3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-meteorlxy"><header class="header" style="background-size:cover;background-repeat:no-repeat;background-position:center;background-attachment:scroll;background-image:url(http://img.icoisini.xyz/background.jpg);" data-v-7a046aea><div data-v-e4145d0a data-v-7a046aea><nav class="navbar" data-v-e4145d0a><div class="container" data-v-e4145d0a><a href="/post-ci/" class="router-link-active" data-v-e4145d0a><span class="navbar-site-name" data-v-e4145d0a>
          Csrsm
        </span></a> <div class="navbar-toggler" data-v-e4145d0a><svg class="icon" style="font-size:1.2em;" data-v-e4145d0a data-v-e4145d0a><title data-v-e4145d0a data-v-e4145d0a>menu</title><use xlink:href="#icon-menu" data-v-e4145d0a data-v-e4145d0a></use></svg></div> <div class="navbar-links" data-v-e4145d0a><a href="/post-ci/" class="navbar-link" data-v-e4145d0a>
            首页
          </a><a href="/post-ci/posts/" class="navbar-link router-link-active" data-v-e4145d0a>
            Csrsm
          </a></div></div></nav> <div class="navbar-holder" style="display:none;" data-v-e4145d0a></div></div> <div class="banner" data-v-98d6aa8c data-v-7a046aea data-v-7a046aea><div class="container" data-v-98d6aa8c><div class="center" data-v-98d6aa8c><h1 data-v-98d6aa8c data-v-7a046aea>
          Vue
        </h1></div></div></div></header> <div class="container clearfix show-aside" data-v-4dd605a1 data-v-4dd605a1><main class="main" data-v-4dd605a1><div class="post" data-v-4dd605a1 data-v-4dd605a1><section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      发布时间 : 2020-11-23
    </span> <span class="update-date" data-v-4e23451f>
      最后修改 : 2022-12-08
    </span></section> <section class="post-links" data-v-4e23451f><a href="/post-ci/posts/2020/11/21/eureka-protect.html" class="post-link" data-v-4e23451f>
      上一篇 : Eureka的自我保护机制
    </a> <a href="/post-ci/posts/2020/11/23/maven.html" class="post-link" data-v-4e23451f>
      下一篇 : dependencyManagement和dependencies
    </a></section></section> <article class="main-div"><div class="post-content content content__default"><h1 id="vue-router"><a href="#vue-router" class="header-anchor">#</a> vue-router</h1> <ol><li><h3 id="vue-router-是干嘛的"><a href="#vue-router-是干嘛的" class="header-anchor">#</a> Vue Router 是干嘛的？</h3></li></ol> <blockquote><p>用 Vue.js + Vue Router 创建单页应用。</p></blockquote> <ol start="2"><li><h3 id="什么是单页应用"><a href="#什么是单页应用" class="header-anchor">#</a> 什么是单页应用</h3></li></ol> <blockquote><p>单页应用的全称是 single-page application，简称 SPA，它是一种网站应用的模型，它可以动态重写当前的页面来与用户交互，而不需要重新加载整个页面。
说白就是无刷新，整个webapp就一个html文件，里面的各个功能页面是javascript通过hash,或者history api来进行路由，并通过ajax拉取数据来实现响应功能。因为整个webapp就一个html，所以叫单页面！</p></blockquote> <ol start="3"><li><h3 id="hash和history是啥"><a href="#hash和history是啥" class="header-anchor">#</a> hash和history是啥？</h3> <blockquote><p><code>vue-router</code> 默认 hash 模式 —— 使用 URL 的 hash 来模拟一个完整的 URL，于是当 URL 改变时，页面不会重新加载。如果不想要很丑的 hash，我们可以用路由的 <strong>history 模式</strong>，这种模式充分利用 <code>history.pushState</code> API 来完成 URL 跳转而无须重新加载页面</p></blockquote> <h4 id="_3-1-为什么要有hash和history"><a href="#_3-1-为什么要有hash和history" class="header-anchor">#</a> 3.1 为什么要有hash和history？</h4> <blockquote><p>对于 Vue 这类渐进式前端开发框架，为了构建 SPA（单页面应用），需要引入前端路由系统，这也就是 Vue-Router 存在的意义。前端路由的核心，就在于 —— 改变视图的同时不会向后端发出请求。为了达到这一目的，浏览器当前提供了以下两种支持：</p></blockquote> <ul><li>hash —— 即地址栏 URL 中的 # 符号（此 hash 不是密码学里的散列运算）。</li></ul> <p>比如这个 URL：</p> <div class="language- extra-class"><pre class="language-text"><code>http://localhost:8080/#/hello
</code></pre></div><p>hash 的值为 #/hello。它的特点在于：hash 虽然出现在 URL 中，但不会被包括在 HTTP 请求中，对后端完全没有影响，因此改变 hash 不会重新加载页面。</p> <ul><li>history —— 利用了 HTML5 History Interface 中新增的 pushState() 和replaceState() 方法。（需要特定浏览器支持）</li></ul> <blockquote><p>这两个方法应用于浏览器的历史记录栈，在当前已有的 back、forward、go 的基础之上，它们提供了对历史记录进行修改的功能。只是当它们执行修改时，虽然改变了当前的 URL，但浏览器不会立即向后端发送请求。因此可以说，hash 模式和 history 模式都属于浏览器自身的特性，Vue-Router 只是利用了这两个特性（通过调用浏览器提供的接口）来实现前端路由。</p></blockquote> <blockquote><p>history 也不是样样都好。SPA 虽然在浏览器里游刃有余，但真要通过 URL 向后端发起 HTTP 请求时，两者的差异就来了。尤其在用户手动输入 URL 后回车，或者刷新（重启）浏览器的时候。</p></blockquote> <ul><li><p>hash 模式下，仅 hash 符号之前的内容会被包含在请求中，如</p> <div class="language- extra-class"><pre class="language-text"><code>http://www.abc.com
</code></pre></div><p>，因此对于后端来说，即使没有做到对路由的全覆盖，也不会返回 404 错误。</p></li> <li><p>history 模式下，前端的 URL 必须和实际向后端发起请求的 URL 一致，如</p> <div class="language- extra-class"><pre class="language-text"><code>http://www.abc.com/book/id
</code></pre></div><p>如果后端缺少对 /book/id 的路由处理，将返回 404 错误。<a href="https://router.vuejs.org/zh-cn/essentials/history-mode.html" target="_blank" rel="noopener noreferrer">Vue-Router 官网<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>里如此描述：“不过这种模式要玩好，还需要后台配置支持……所以呢，你要在服务端增加一个覆盖所有情况的候选资源：如果 URL 匹配不到任何静态资源，则应该返回同一个 index.html 页面，这个页面就是你 app 依赖的页面。”</p></li></ul></li> <li><h3 id="单页面应用和多页面应用的区别是啥-各自使用场景是啥"><a href="#单页面应用和多页面应用的区别是啥-各自使用场景是啥" class="header-anchor">#</a> 单页面应用和多页面应用的区别是啥？各自使用场景是啥？</h3> <blockquote><p>单页面应用（SinglePage Web Application，SPA）
只有一张Web页面的应用，是一种从Web服务器加载的富客户端，单页面跳转仅刷新局部资源 ，公共资源(js、css等)仅需加载一次，常用于PC端官网、购物等网站</p></blockquote></li></ol> <img src="/post-ci/img/one.png" alt="单架构"> <blockquote><p>多页面应用（MultiPage Application，MPA）
多页面跳转刷新所有资源，每个公共资源(js、css等)需选择性重新加载，常用于 app 或 客户端等</p></blockquote> <img src="/post-ci/img/more.png" alt="单架构"> <ul><li><p>区别：</p> <img src="/post-ci/img/more.png" alt="单架构"></li> <li><p>备注：</p></li></ul> <blockquote><p>vue对seo太不友好了，单页面SPA应用就是实时渲染的，爬虫都爬不到SEO是搜索引擎优化的意思。
主要是优化好自己的网站，方zhi便搜索引擎找到你，让你的排名在搜索的时候可以排在前面。让更多的人知道你的网站，是网站推广的一种方式SSR服务端渲染：SSR的出现一定程度上解决了SPA首屏慢的问题，又极大的减少了SPA对于SEO的不利影响。</p></blockquote> <ul><li>优点：更快的响应时间，不用等待所有的js都下载完成，显示器便能显示出比较完整的页面；</li></ul> <p>​            更好的SSR，我们可以将SEO关键信息直接在后台渲染成html，从而保证了搜索引擎可以提取到相应数据。</p> <ul><li>缺点：占用了大量的CPU和内存资源</li></ul> <blockquote><p>vue的服务端渲染框架——NUXT</p></blockquote> <ul><li>课后问题：服务端渲染和客户端的渲染的区别和优缺点？</li></ul> <h2 id="页面跳转"><a href="#页面跳转" class="header-anchor">#</a> 页面跳转</h2> <ol><li>定义 (路由) 组件。</li> <li>定义路由</li> <li>创建 router 实例，然后传 <code>routes</code> 配置</li> <li>创建和挂载根实例。</li></ol> <h2 id="页面传值"><a href="#页面传值" class="header-anchor">#</a> 页面传值</h2> <h3 id="query-id-1"><a href="#query-id-1" class="header-anchor">#</a> query ? id = 1</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>router<span class="token operator">-</span>link <span class="token operator">:</span>to<span class="token operator">=</span><span class="token string">&quot;`/foo?id=${item.id}`&quot;</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>link<span class="token operator">&gt;</span>
</code></pre></div><h3 id="获取query传递参数"><a href="#获取query传递参数" class="header-anchor">#</a> 获取query传递参数</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>query<span class="token punctuation">.</span>id
</code></pre></div><h3 id="动态路由传值"><a href="#动态路由传值" class="header-anchor">#</a> 动态路由传值</h3> <blockquote><p>动态路由：我们经常需要把某种模式匹配到的所有路由，全都映射到同个组件。例如，我们有一个 <code>User</code> 组件，对于所有 ID 各不相同的用户，都要使用这个组件来渲染。</p></blockquote> <div class="language-javascript extra-class"><pre class="language-javascript"><code> <span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/info/:id'</span><span class="token punctuation">,</span> <span class="token literal-property property">component</span><span class="token operator">:</span> info <span class="token punctuation">}</span>
 <span class="token operator">&lt;</span>router<span class="token operator">-</span>link to<span class="token operator">=</span><span class="token string">&quot;/info/6&quot;</span><span class="token operator">&gt;</span> 动态路由传值 菠萝<span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>link<span class="token operator">&gt;</span>
 <span class="token punctuation">{</span> <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/info/:id/:name'</span><span class="token punctuation">,</span> <span class="token literal-property property">component</span><span class="token operator">:</span> info <span class="token punctuation">}</span>  <span class="token comment">// 参数不能少</span>
</code></pre></div><h3 id="高级匹配"><a href="#高级匹配" class="header-anchor">#</a> 高级匹配</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code> <span class="token punctuation">{</span>
  <span class="token comment">// 会匹配所有路径</span>
  <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'*'</span>
<span class="token punctuation">}</span>
<span class="token punctuation">{</span>
  <span class="token comment">// 会匹配以 `/user-` 开头的任意路径</span>
  <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/user-*'</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>优先级：同一个路径可以匹配多个路由，此时，匹配的优先级就按照路由的定义顺序：谁先定义的，谁的优先级就最高。</p></blockquote> <h2 id="嵌套路由-一个页面有多个子页面"><a href="#嵌套路由-一个页面有多个子页面" class="header-anchor">#</a> 嵌套路由 一个页面有多个子页面</h2> <div class="language- extra-class"><pre class="language-text"><code>  {
    path: '/names',
    component: names, 
    &lt;!-- redirect:&quot;/names/c&quot;,  //重定向  ：默认跳转页面   --&gt;
    children: [{
        path: 'a',  // names/a    a前不加/ 以父元素为根节点   加/以域名为根节点
        component: a
      },
      {
        path: 'b', // names/b
        component: b
      },
      {
        path: 'c',
        component: c
      },
      {
        path: 'd',
        component: d
      }
    ]
  },
   &lt;ul&gt;
      &lt;li&gt;
          &lt;router-link to=&quot;/names/a&quot;&gt;a页面&lt;/router-link&gt;
          &lt;router-link to=&quot;/names/b&quot;&gt;b页面&lt;/router-link&gt;
          &lt;router-link to=&quot;/names/c&quot;&gt;c页面&lt;/router-link&gt;
          &lt;router-link to=&quot;/names/d&quot;&gt;d页面&lt;/router-link&gt;
          &lt;/li&gt;
    &lt;/ul&gt;
    &lt;router-view&gt;&lt;/router-view&gt;
</code></pre></div><h2 id="路由跳转的几种写法"><a href="#路由跳转的几种写法" class="header-anchor">#</a> 路由跳转的几种写法</h2> <h3 id="字符串的方式跳转"><a href="#字符串的方式跳转" class="header-anchor">#</a> 字符串的方式跳转</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>router<span class="token operator">-</span>link <span class="token operator">:</span>to<span class="token operator">=</span><span class="token string">&quot;`/foo?id=${item.id}`&quot;</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>link<span class="token operator">&gt;</span>
</code></pre></div><h3 id="对象的方式跳转"><a href="#对象的方式跳转" class="header-anchor">#</a> 对象的方式跳转</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>router<span class="token operator">-</span>link <span class="token operator">:</span>to<span class="token operator">=</span><span class="token string">&quot;{path: '/bar'}&quot;</span><span class="token operator">&gt;</span>Go to Bar<span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>link<span class="token operator">&gt;</span>
</code></pre></div><h3 id="对象的方式传值"><a href="#对象的方式传值" class="header-anchor">#</a> 对象的方式传值</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>router<span class="token operator">-</span>link <span class="token operator">:</span>to<span class="token operator">=</span><span class="token string">&quot;{path: '/bar',query:{id:7}}&quot;</span><span class="token operator">&gt;</span>Go to Bar<span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>link<span class="token operator">&gt;</span>
</code></pre></div><h3 id="对象的方式动态路由"><a href="#对象的方式动态路由" class="header-anchor">#</a> 对象的方式动态路由</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>不能直接传递  用到命名路由
<span class="token operator">&lt;</span>router<span class="token operator">-</span>link <span class="token operator">:</span>to<span class="token operator">=</span><span class="token string">&quot;{name: 'info',params:{id:7,name:'测试'}}&quot;</span><span class="token operator">&gt;</span>Go to   Info<span class="token operator">&lt;</span>router<span class="token operator">-</span>link<span class="token operator">&gt;</span>
<span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/info/:id/:name'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'info'</span><span class="token punctuation">,</span> <span class="token comment">//命名路由</span>
    <span class="token literal-property property">component</span><span class="token operator">:</span> info
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
 注意：如果提供了 path，params 会被忽略，你需要提供路由的 name 或手写完整的带有参数的 path：
</code></pre></div><h3 id="js的方式传值"><a href="#js的方式传值" class="header-anchor">#</a> js的方式传值</h3> <p>编程式导航</p> <p>除了使用 <code>&lt;router-link&gt;</code> 创建 a 标签来定义导航链接，我们还可以借助 router 的实例方法，通过编写代码来实现</p> <table><thead><tr><th>声明式</th> <th>编程式</th></tr></thead> <tbody><tr><td><code>&lt;router-link :to=&quot;...&quot;&gt;</code></td> <td><code>router.push(...)</code></td></tr></tbody></table> <div class="language- extra-class"><pre><code> &lt;!-- window.location.href=&quot;&quot; --&gt;
methods: {
  goto() {
    // this.$router   当前路由对象 获取当前路由属性和方法
    // this.$router  所有的路由对象 可以理解为routes 用于页面跳转
    // this.$router.push(&quot;/foo&quot;)
     this.$router.push({ path: '/foo' })
  },
  goto1() {
    //  this.$router.push(&quot;/info/6/daming&quot;)
     this.$router.push({ name: 'info', params: { id: 7, name: '测试' } })
  },
  goto2() {
    //  this.$router.push(&quot;/foo?id=1&amp;name=大明&quot; )
     this.$router.push({path: '/bar',query:{id:7}})
  }
</code></pre></div><h2 id="导航守卫"><a href="#导航守卫" class="header-anchor">#</a> 导航守卫</h2> <p>控制页面间的跳转</p> <h3 id="全局守卫"><a href="#全局守卫" class="header-anchor">#</a> 全局守卫</h3> <ul><li><p>全局前置守卫
用于控制路由的每一次跳转过程</p> <div class="language- extra-class"><pre class="language-text"><code>- //全局前置守卫
  router.beforeEach((to,from,next)=&gt;{
      // to 代表去的路由 
      // from 代表来自于哪个路由
      // next 控制路由的跳转next()和取消跳转next(false) 
      // next 重新定向到某个页面 next(&quot;login&quot;)
      console.log(to,from,next);
      if(to.path == '/user' || to.path == '/goods'){
        var token = localStorage.getItem(&quot;token&quot;)
        if(token){
          next();
        }else{
          next(&quot;/login&quot;)
        }
        // next(false);
        // next(&quot;/login&quot;)
      }else{
        next();
      }
    })
</code></pre></div></li> <li><p>全局后置守卫 router.afterEach((to, from)  这些钩子不会接受 <code>next</code> 函数也不会改变导航本身</p> <p>修改title</p></li> <li><p>全局解析守卫 router.beforeResolve</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//这里根据单页面name的指向不同，去访问的接口域名也不同</span>
router<span class="token punctuation">.</span><span class="token function">beforeResolve</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> url<span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>
    to<span class="token punctuation">.</span>matched<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">&quot;broker-shop&quot;</span> <span class="token operator">||</span>
    to<span class="token punctuation">.</span>matched<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">&quot;information&quot;</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    url <span class="token operator">=</span> <span class="token string">&quot;https://ddd.zhaoshang800.com&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>matched<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">&quot;brokerage-list&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    url <span class="token operator">=</span> <span class="token string">&quot;https://aaa.zhaoshang800.com&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>matched<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">&quot;sellhot&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    url <span class="token operator">=</span> <span class="token string">&quot;https://bbb.zhaoshang800.com&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>matched<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>name <span class="token operator">==</span> <span class="token string">&quot;enterprise-index&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    url <span class="token operator">=</span> <span class="token string">&quot;http://ccc.zhaoshang800.com&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    url <span class="token operator">=</span> <span class="token string">&quot;https://&quot;</span> <span class="token operator">+</span> location<span class="token punctuation">.</span>host<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  axios<span class="token punctuation">.</span>defaults<span class="token punctuation">.</span>baseURL <span class="token operator">=</span> url<span class="token punctuation">;</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h3 id="路由守卫-运行在路由上的守卫-只有进入到当前页面的时候才会执行的守卫函数"><a href="#路由守卫-运行在路由上的守卫-只有进入到当前页面的时候才会执行的守卫函数" class="header-anchor">#</a> 路由守卫 :运行在路由上的守卫，只有进入到当前页面的时候才会执行的守卫函数</h3> <div class="language- extra-class"><pre class="language-text"><code>{
    path: '/user',
    component: user,
    beforeEnter(to,from,next){
        console.log(to,from,next);
        var token = localStorage.getItem(&quot;token&quot;)
    if(token){
      next();
    }else{
      next(&quot;/login&quot;)
    } 
    }
  },
</code></pre></div><h3 id="组件守卫"><a href="#组件守卫" class="header-anchor">#</a> 组件守卫</h3> <ul><li><p>beforeRouteEnter 进入组件之前执行的守卫函数
//进入组件之前执行的守卫函数</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//beforeRouteEnter 中不能访问当前组件实例的方法和属性</span>
  <span class="token function">beforeRouteEnter</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> token <span class="token operator">=</span> localStorage<span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>path <span class="token operator">==</span> <span class="token string">'/goods'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>token<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token function">next</span><span class="token punctuation">(</span><span class="token string">&quot;/login&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div></li> <li><p>beforeRouteUpdate 组件复用的时候执行的守卫函数 目前只有一种情况会复用 连续进入同一个动态路由页面的时候会复用
复用就会导致组件创建阶段的生命周期钩子不会运行</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 组件被复用的时候调用的守卫函数</span>
<span class="token function">beforeRouteUpdate</span><span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span>from<span class="token punctuation">,</span>next</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token operator">=</span>to<span class="token punctuation">.</span>params<span class="token punctuation">.</span>id<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token operator">=</span>to<span class="token punctuation">.</span>params<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div></li> <li><p>beforeRouteLeave 离开之前执行的守卫函数 beforeDestroy类似</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>
<span class="token comment">// 在离开该组件执行的函数</span>
  <span class="token comment">// next 不加就离不开当前页面 </span>
  <span class="token comment">//   1. 浏览器前进后退 时提醒 阻止离开 不刷新  </span>
  <span class="token comment">//   2. 清除页面定时器</span>
<span class="token function">beforeRouteLeave</span><span class="token punctuation">(</span>to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> next<span class="token punctuation">)</span> 
    <span class="token keyword">var</span> confirms <span class="token operator">=</span> window<span class="token punctuation">.</span><span class="token function">confirm</span><span class="token punctuation">(</span><span class="token string">'你是否填写完毕表单内容'</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>confirms<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>   
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><h2 id="完整的导航解析流程"><a href="#完整的导航解析流程" class="header-anchor">#</a> 完整的导航解析流程</h2> <ol><li>导航被触发。</li></ol></li></ul> <ol start="2"><li><p>在失活的组件里调用 <code>beforeRouteLeave</code> 守卫。</p></li> <li><p>调用全局的 <code>beforeEach</code> 守卫。</p></li> <li><p>在重用的组件里调用 <code>beforeRouteUpdate</code> 守卫 (2.2+)。</p></li> <li><p>在路由配置里调用 <code>beforeEnter</code>。</p></li> <li><p>解析异步路由组件。</p></li> <li><p>在被激活的组件里调用 <code>beforeRouteEnter</code>。</p></li> <li><p>调用全局的 <code>beforeResolve</code> 守卫 (2.5+)。</p></li> <li><p>导航被确认。</p></li> <li><p>调用全局的 <code>afterEach</code> 钩子。</p></li> <li><p>触发 DOM 更新。</p></li> <li><p>调用 <code>beforeRouteEnter</code> 守卫中传给 <code>next</code> 的回调函数，创建好的组件实例会作为回调函数的参数传入。</p> <p>当点击切换路由时：beforeRouterLeave--&gt;beforeEach--&gt;beforeEnter--&gt;beforeRouteEnter--&gt;beforeResolve--&gt;afterEach--&gt;beforeCreate--&gt;created--&gt;beforeMount--&gt;mounted--&gt;beforeRouteEnter的next的回调</p></li></ol> <h3 id="路由元信息"><a href="#路由元信息" class="header-anchor">#</a> 路由元信息</h3> <p>路由元信息 定义在当前路由上面的自定义信息 这个可以被当前路由调用
应用：页面标题的赋值</p> <div class="language- extra-class"><pre><code> {
    path: '/goods',
    // component: goods,
    meta:{
      title:&quot;goods页面&quot;
    },
    component: () =&gt; import('@/view/goods/index')
  },
### 过渡动画
 &lt;transition :enter-active-class=&quot;currentClassname&quot;&gt;
  &lt;router-view&gt;&lt;/router-view&gt;
&lt;/transition&gt;
import '@/assets/css/animate.css' 
 watch: {
$route: function (to, from) {
  console.log(to, from);
//选用判断页面还是后退
  // 判断用户是进入还是离开的行为 可以通过地址栏长度进行判断
  // 如果to的路由长度 大于 from的路由长度 是进入行为   fadeInRight ，相反 是返回行为 fadeInLeft
  var toLength = to.path.split(&quot;/&quot;).length;
  var fromLength = from.path.split(&quot;/&quot;).length; 
  if (toLength &gt; fromLength) {
    this.currentClassname = &quot;fadeInRight animated&quot;;
  } else if (fromLength &gt; toLength) {
  this.currentClassname = &quot;fadeInLeft animated&quot;;
} else {
    this.currentClassname = &quot;fadeIn animated&quot;;
  } 
},
</code></pre></div><p>},</p> <h3 id="滚动行为"><a href="#滚动行为" class="header-anchor">#</a> 滚动行为</h3> <p>传统开发 当页面切换的时候滚动条距离页面顶的高度为0
单页面应用  当页面切换的时候滚动条距离页面顶的高度不变化</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">new</span> <span class="token class-name">VueRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">mode</span><span class="token operator">:</span> <span class="token string">&quot;history&quot;</span><span class="token punctuation">,</span> <span class="token comment">//hash history 默认hash url有#号</span>
  <span class="token function">scrollBehavior</span> <span class="token punctuation">(</span><span class="token parameter">to<span class="token punctuation">,</span> from<span class="token punctuation">,</span> savedPosition</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span> <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  routes
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="路由懒加载"><a href="#路由懒加载" class="header-anchor">#</a> 路由懒加载</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code>  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token comment">/* webpackChunkName: &quot;group-foo&quot; */</span> <span class="token string">'./Foo.vue'</span><span class="token punctuation">)</span>
</code></pre></div><p>通过这个写法 就大大的减少了初始化项目时app.js 文件的体积</p></div></article> <section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      发布时间 : 2020-11-23
    </span> <span class="update-date" data-v-4e23451f>
      最后修改 : 2022-12-08
    </span></section> <section class="post-links" data-v-4e23451f><a href="/post-ci/posts/2020/11/21/eureka-protect.html" class="post-link" data-v-4e23451f>
      上一篇 : Eureka的自我保护机制
    </a> <a href="/post-ci/posts/2020/11/23/maven.html" class="post-link" data-v-4e23451f>
      下一篇 : dependencyManagement和dependencies
    </a></section></section> <div id="post-comments" class="main-div"><!----></div></div></main> <aside class="aside" data-v-4dd605a1><div class="info-card main-div" data-v-9d847660 data-v-4dd605a1><div class="info-card-header" style="background-size:cover;background-repeat:no-repeat;background-position:center;background-attachment:scroll;background-image:url(http://img.icoisini.xyz/wx-background.jpg);" data-v-9d847660><img src="http://img.icoisini.xyz/cm.jpg" alt="小二哥" class="info-avatar" data-v-9d847660></div> <div class="info-card-body" data-v-9d847660><section class="info-nickname" data-v-9d847660>
      小二哥
    </section> <section class="info-desc" data-v-9d847660>Don`t Worry Be Happy!</section> <section class="info-contact" data-v-9d847660><section data-v-9d847660><span title="DaLian City, China" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>DaLian City, China</title><use xlink:href="#icon-location" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          DaLian City, China
        </span></span></section> <section data-v-9d847660><span title="DaLian University of Technology" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>DaLian University of Technology</title><use xlink:href="#icon-organization" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          DaLian University of Technology
        </span></span></section> <section data-v-9d847660><a href="mailto:csrsming@163.com" title="csrsming@163.com" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>csrsming@163.com</title><use xlink:href="#icon-email" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          csrsming@163.com
        </span></a></section></section></div> <div class="info-card-footer" data-v-9d847660><section class="info-sns clearfix" data-v-9d847660><a href="https://github.com/csrsm" target="_blank" class="sns-link" data-v-9d847660><span title="GitHub: csrsm" class="sns-icon" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1.5em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>GitHub: csrsm</title><use xlink:href="#icon-github" data-v-9d847660 data-v-9d847660></use></svg></span></a></section></div></div> <div class="post-nav-card main-div" style="position:relative;top:0;width:0px;" data-v-4dd605a1><div class="post-nav-contents"><svg class="icon"><title>book</title><use xlink:href="#icon-book"></use></svg> <span>文章目录</span> <div class="post-nav-toc"><ul><li><a href="/post-ci/posts/2020/11/23/vue.html#vue-router-是干嘛的">Vue Router 是干嘛的？</a><ul><li><a href="/post-ci/posts/2020/11/23/vue.html#什么是单页应用">什么是单页应用</a></li><li><a href="/post-ci/posts/2020/11/23/vue.html#hash和history是啥">hash和history是啥？</a></li><li><a href="/post-ci/posts/2020/11/23/vue.html#单页面应用和多页面应用的区别是啥-各自使用场景是啥">单页面应用和多页面应用的区别是啥？各自使用场景是啥？</a></li></ul></li><li><a href="/post-ci/posts/2020/11/23/vue.html#页面跳转">页面跳转</a></li><li><a href="/post-ci/posts/2020/11/23/vue.html#页面传值">页面传值</a><ul><li><a href="/post-ci/posts/2020/11/23/vue.html#query-id-1">query ? id = 1</a></li><li><a href="/post-ci/posts/2020/11/23/vue.html#获取query传递参数">获取query传递参数</a></li><li><a href="/post-ci/posts/2020/11/23/vue.html#动态路由传值">动态路由传值</a></li><li><a href="/post-ci/posts/2020/11/23/vue.html#高级匹配">高级匹配</a></li></ul></li><li><a href="/post-ci/posts/2020/11/23/vue.html#嵌套路由-一个页面有多个子页面">嵌套路由 一个页面有多个子页面</a></li><li><a href="/post-ci/posts/2020/11/23/vue.html#路由跳转的几种写法">路由跳转的几种写法</a><ul><li><a href="/post-ci/posts/2020/11/23/vue.html#字符串的方式跳转">字符串的方式跳转</a></li><li><a href="/post-ci/posts/2020/11/23/vue.html#对象的方式跳转">对象的方式跳转</a></li><li><a href="/post-ci/posts/2020/11/23/vue.html#对象的方式传值">对象的方式传值</a></li><li><a href="/post-ci/posts/2020/11/23/vue.html#对象的方式动态路由">对象的方式动态路由</a></li><li><a href="/post-ci/posts/2020/11/23/vue.html#js的方式传值">js的方式传值</a></li></ul></li><li><a href="/post-ci/posts/2020/11/23/vue.html#导航守卫">导航守卫</a><ul><li><a href="/post-ci/posts/2020/11/23/vue.html#全局守卫">全局守卫</a></li><li><a href="/post-ci/posts/2020/11/23/vue.html#路由守卫-运行在路由上的守卫-只有进入到当前页面的时候才会执行的守卫函数">路由守卫 :运行在路由上的守卫，只有进入到当前页面的时候才会执行的守卫函数</a></li><li><a href="/post-ci/posts/2020/11/23/vue.html#组件守卫">组件守卫</a></li></ul></li><li><a href="/post-ci/posts/2020/11/23/vue.html#完整的导航解析流程">完整的导航解析流程</a><ul><li><a href="/post-ci/posts/2020/11/23/vue.html#路由元信息">路由元信息</a></li><li><a href="/post-ci/posts/2020/11/23/vue.html#滚动行为">滚动行为</a></li><li><a href="/post-ci/posts/2020/11/23/vue.html#路由懒加载">路由懒加载</a></li></ul></li></ul></div></div> <div class="post-nav-comments"><svg class="icon"><title>comment</title><use xlink:href="#icon-comment"></use></svg> <a href="/post-ci/posts/2020/11/23/vue.html#post-comments">
      评论
    </a></div></div></aside></div> <footer class="footer" data-v-1375e54c><p class="footer-sns-links" data-v-1375e54c><a href="https://github.com/csrsm" target="_blank" class="sns-link" data-v-1375e54c><span title="GitHub: csrsm" class="sns-icon" data-v-1375e54c data-v-1375e54c><svg class="icon" style="font-size:25px;" data-v-1375e54c data-v-1375e54c><title data-v-1375e54c data-v-1375e54c>GitHub: csrsm</title><use xlink:href="#icon-github" data-v-1375e54c data-v-1375e54c></use></svg></span></a></p> <!----> <p class="footer-text" data-v-1375e54c>Copyright 2016-present <a href="https://github.com/csrsm" target="_blank">csrsm</a></p></footer></div><div class="global-ui"><!----><!----></div></div>
    <script src="/post-ci/assets/js/app.2051f0b8.js" defer></script><script src="/post-ci/assets/js/7.8eaaf042.js" defer></script><script src="/post-ci/assets/js/50.186a336f.js" defer></script>
  </body>
</html>
