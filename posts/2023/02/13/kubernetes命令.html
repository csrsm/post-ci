<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Kubernetes命令 | Csrsm</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/post-ci/img/favicon.ico">
    <meta name="description" content="This is my blog">
    <link rel="preload" href="/post-ci/assets/css/0.styles.0012e2a3.css" as="style"><link rel="preload" href="/post-ci/assets/js/app.f434079f.js" as="script"><link rel="preload" href="/post-ci/assets/js/7.8eaaf042.js" as="script"><link rel="preload" href="/post-ci/assets/js/22.3329f709.js" as="script"><link rel="prefetch" href="/post-ci/assets/js/1.2e718cca.js"><link rel="prefetch" href="/post-ci/assets/js/10.503da5e1.js"><link rel="prefetch" href="/post-ci/assets/js/11.9d2fdfae.js"><link rel="prefetch" href="/post-ci/assets/js/12.fcb21a1d.js"><link rel="prefetch" href="/post-ci/assets/js/13.96503fd7.js"><link rel="prefetch" href="/post-ci/assets/js/14.20d93468.js"><link rel="prefetch" href="/post-ci/assets/js/15.f0e991c0.js"><link rel="prefetch" href="/post-ci/assets/js/16.033ef5c4.js"><link rel="prefetch" href="/post-ci/assets/js/17.ad79235f.js"><link rel="prefetch" href="/post-ci/assets/js/18.0505af28.js"><link rel="prefetch" href="/post-ci/assets/js/19.70092390.js"><link rel="prefetch" href="/post-ci/assets/js/20.e393cae7.js"><link rel="prefetch" href="/post-ci/assets/js/21.0973e7c3.js"><link rel="prefetch" href="/post-ci/assets/js/23.1c2d7d48.js"><link rel="prefetch" href="/post-ci/assets/js/24.2bbbae87.js"><link rel="prefetch" href="/post-ci/assets/js/25.e2d55e6c.js"><link rel="prefetch" href="/post-ci/assets/js/26.4f4b6751.js"><link rel="prefetch" href="/post-ci/assets/js/27.e2ce2855.js"><link rel="prefetch" href="/post-ci/assets/js/28.33d7a492.js"><link rel="prefetch" href="/post-ci/assets/js/29.512128c3.js"><link rel="prefetch" href="/post-ci/assets/js/3.ff189134.js"><link rel="prefetch" href="/post-ci/assets/js/30.5336d253.js"><link rel="prefetch" href="/post-ci/assets/js/31.87b9a222.js"><link rel="prefetch" href="/post-ci/assets/js/32.b16f9ee5.js"><link rel="prefetch" href="/post-ci/assets/js/33.e4913f80.js"><link rel="prefetch" href="/post-ci/assets/js/34.b0fdd153.js"><link rel="prefetch" href="/post-ci/assets/js/35.f0994930.js"><link rel="prefetch" href="/post-ci/assets/js/36.ab339a1d.js"><link rel="prefetch" href="/post-ci/assets/js/37.bb5c491b.js"><link rel="prefetch" href="/post-ci/assets/js/38.7afe4939.js"><link rel="prefetch" href="/post-ci/assets/js/39.91db993c.js"><link rel="prefetch" href="/post-ci/assets/js/4.326ff035.js"><link rel="prefetch" href="/post-ci/assets/js/40.2ac40498.js"><link rel="prefetch" href="/post-ci/assets/js/41.9da85d02.js"><link rel="prefetch" href="/post-ci/assets/js/42.427d852c.js"><link rel="prefetch" href="/post-ci/assets/js/43.ff39cf08.js"><link rel="prefetch" href="/post-ci/assets/js/44.cba928a5.js"><link rel="prefetch" href="/post-ci/assets/js/45.352ae01d.js"><link rel="prefetch" href="/post-ci/assets/js/46.f9d59464.js"><link rel="prefetch" href="/post-ci/assets/js/47.d35f6d84.js"><link rel="prefetch" href="/post-ci/assets/js/48.ef4a5f7b.js"><link rel="prefetch" href="/post-ci/assets/js/49.5d627a0e.js"><link rel="prefetch" href="/post-ci/assets/js/5.f96cd824.js"><link rel="prefetch" href="/post-ci/assets/js/50.fab4ccc6.js"><link rel="prefetch" href="/post-ci/assets/js/51.a1f72564.js"><link rel="prefetch" href="/post-ci/assets/js/52.552235e2.js"><link rel="prefetch" href="/post-ci/assets/js/53.0b60c227.js"><link rel="prefetch" href="/post-ci/assets/js/54.5a97decb.js"><link rel="prefetch" href="/post-ci/assets/js/55.517779f4.js"><link rel="prefetch" href="/post-ci/assets/js/56.2bcb7b9d.js"><link rel="prefetch" href="/post-ci/assets/js/57.da623f96.js"><link rel="prefetch" href="/post-ci/assets/js/58.1c36665a.js"><link rel="prefetch" href="/post-ci/assets/js/59.f0ec58cd.js"><link rel="prefetch" href="/post-ci/assets/js/6.562b2ef1.js"><link rel="prefetch" href="/post-ci/assets/js/60.c4b35501.js"><link rel="prefetch" href="/post-ci/assets/js/8.40f58b51.js"><link rel="prefetch" href="/post-ci/assets/js/9.c8fcfbba.js">
    <link rel="stylesheet" href="/post-ci/assets/css/0.styles.0012e2a3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div id="vuepress-theme-meteorlxy"><header class="header" style="background-size:cover;background-repeat:no-repeat;background-position:center;background-attachment:scroll;background-image:url(/img/0010.png);" data-v-7a046aea><div data-v-e4145d0a data-v-7a046aea><nav class="navbar" data-v-e4145d0a><div class="container" data-v-e4145d0a><a href="/post-ci/" class="router-link-active" data-v-e4145d0a><span class="navbar-site-name" data-v-e4145d0a>
          Csrsm
        </span></a> <div class="navbar-toggler" data-v-e4145d0a><svg class="icon" style="font-size:1.2em;" data-v-e4145d0a data-v-e4145d0a><title data-v-e4145d0a data-v-e4145d0a>menu</title><use xlink:href="#icon-menu" data-v-e4145d0a data-v-e4145d0a></use></svg></div> <div class="navbar-links" data-v-e4145d0a><a href="/post-ci/" class="navbar-link" data-v-e4145d0a>
            首页
          </a><a href="/post-ci/posts/" class="navbar-link router-link-active" data-v-e4145d0a>
            Csrsm
          </a></div></div></nav> <div class="navbar-holder" style="display:none;" data-v-e4145d0a></div></div> <div class="banner" data-v-98d6aa8c data-v-7a046aea data-v-7a046aea><div class="container" data-v-98d6aa8c><div class="center" data-v-98d6aa8c><h1 data-v-98d6aa8c data-v-7a046aea>
          Kubernetes命令
        </h1></div></div></div></header> <div class="container clearfix show-aside" data-v-4dd605a1 data-v-4dd605a1><main class="main" data-v-4dd605a1><div class="post" data-v-4dd605a1 data-v-4dd605a1><section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      发布时间 : 2023-02-13
    </span> <span class="update-date" data-v-4e23451f>
      最后修改 : 2024-12-12
    </span></section> <section class="post-links" data-v-4e23451f><a href="/post-ci/posts/2023/02/13/kubernetes%E9%83%A8%E7%BD%B2.html" class="post-link" data-v-4e23451f>
      上一篇 : Kubernetes部署
    </a> <a href="/post-ci/posts/2023/02/13/kubernetes-yaml.html" class="post-link" data-v-4e23451f>
      下一篇 : Kubernetes YAML详解
    </a></section></section> <article class="main-div"><div class="post-content content content__default"><h1 id="kubernetes命令"><a href="#kubernetes命令" class="header-anchor">#</a> Kubernetes命令</h1> <h2 id="pod命令"><a href="#pod命令" class="header-anchor">#</a> pod命令</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl get pods
kubectl get pods -o wide <span class="token comment">#详细信息</span>
kubectl <span class="token builtin class-name">exec</span> -it <span class="token punctuation">[</span>pod-name<span class="token punctuation">]</span> <span class="token function">bash</span> <span class="token comment">#进入到一个pod中,pod只有一个容器</span>
kubectl <span class="token builtin class-name">exec</span> -it <span class="token punctuation">[</span>pod-name<span class="token punctuation">]</span> -c <span class="token punctuation">[</span>container-name<span class="token punctuation">]</span> <span class="token function">bash</span> <span class="token comment">#进入到一个pod中,pod有多个容器需要指定容器名称</span>
kubectl delete pod <span class="token punctuation">[</span>pod-name<span class="token punctuation">]</span> -n <span class="token punctuation">[</span>namesapce<span class="token punctuation">]</span>
</code></pre></div><h2 id="label命令"><a href="#label命令" class="header-anchor">#</a> label命令</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl lable <span class="token function">node</span> node1 <span class="token assign-left variable">env_role</span><span class="token operator">=</span>dev  <span class="token comment">#配合nodeSelector使用，进行pod节点选择</span>
</code></pre></div><h2 id="node命令"><a href="#node命令" class="header-anchor">#</a> node命令</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl get nodes
kubectl get nodes k8snode1 --show-labels  <span class="token comment">#显示节点标签</span>
</code></pre></div><h2 id="describe命令"><a href="#describe命令" class="header-anchor">#</a> describe命令</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl describe <span class="token function">node</span> k8smaster <span class="token operator">|</span><span class="token function">grep</span> Taint  <span class="token comment">#查看节点污点信息</span>
</code></pre></div><h2 id="taint命令"><a href="#taint命令" class="header-anchor">#</a> taint命令</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl taint <span class="token function">node</span> <span class="token punctuation">[</span>node<span class="token punctuation">]</span> <span class="token assign-left variable">key</span><span class="token operator">=</span>value:污点三个值 <span class="token comment">#NoSchedule 一定不被调度 PreferNoSchedule 尽量不被调度 NoExecute 不会调度，并且还会驱逐Node已有Pod</span>
kubectl taint <span class="token function">node</span> <span class="token punctuation">[</span>node<span class="token punctuation">]</span> key:污点值-  <span class="token comment">#删除一个节点的污点</span>
</code></pre></div><h2 id="controller命令"><a href="#controller命令" class="header-anchor">#</a> controller命令</h2> <h3 id="deployment"><a href="#deployment" class="header-anchor">#</a> deployment</h3> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl create deployment web --image<span class="token operator">=</span>nginx
kubectl create deployment web --image<span class="token operator">=</span>nginx --dry-run -o yaml <span class="token operator">&gt;</span> web.yaml <span class="token comment">#不创建deployment，导出创建该deployment的yaml文件</span>
kubectl <span class="token builtin class-name">set</span> image deployment web <span class="token assign-left variable">nginx</span><span class="token operator">=</span>nginx:1.15 <span class="token comment">#nginx版本滚动升级</span>
kubectl rollout status deployment web <span class="token comment">#查看升级状态</span>
kubectl rollout <span class="token function">history</span> deployment web <span class="token comment">#查看历史版本</span>
kubectl rollout undo deployment web <span class="token comment">#还原到上一个版本</span>
kubectl rollout undo deployment web --to-reverion<span class="token operator">=</span><span class="token number">2</span> <span class="token comment">#还原到版本2</span>
</code></pre></div><h2 id="service命令"><a href="#service命令" class="header-anchor">#</a> Service命令</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl get svc
kubectl get <span class="token function">service</span>
kubectl edit svc <span class="token punctuation">[</span>svc-name<span class="token punctuation">]</span>
</code></pre></div><h2 id="pod启动调试"><a href="#pod启动调试" class="header-anchor">#</a> Pod启动调试</h2> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment">#启动pod失败可以尝试通过以下两个命令查看失败原因</span>
kubectl -n <span class="token punctuation">[</span>namespaces<span class="token punctuation">]</span> describe pod <span class="token punctuation">[</span>pod-name<span class="token punctuation">]</span> 
kubectl -n <span class="token punctuation">[</span>namespaces<span class="token punctuation">]</span> log <span class="token punctuation">[</span>pod-name<span class="token punctuation">]</span>
</code></pre></div><h2 id="secret命令"><a href="#secret命令" class="header-anchor">#</a> Secret命令</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl create -f secret.yaml
kubectl get secret
</code></pre></div><h2 id="configmap命令"><a href="#configmap命令" class="header-anchor">#</a> ConfigMap命令</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl create configmap redis-config --from-file<span class="token operator">=</span>redis.properties
kubectl get cm
kubectl describe cm redis-config
</code></pre></div><h2 id="namespace命令"><a href="#namespace命令" class="header-anchor">#</a> namespace命令</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl get ns
kubectl create ns <span class="token punctuation">[</span>ns name<span class="token punctuation">]</span>
</code></pre></div><h2 id="万能重启pod命令"><a href="#万能重启pod命令" class="header-anchor">#</a> 万能重启Pod命令</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl get pod <span class="token punctuation">{</span>podname<span class="token punctuation">}</span> -n <span class="token punctuation">{</span>namespace<span class="token punctuation">}</span> -o yaml <span class="token operator">|</span> kubectl replace --force -f -
</code></pre></div><h2 id="进入pod"><a href="#进入pod" class="header-anchor">#</a> 进入pod</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl <span class="token builtin class-name">exec</span> -ti <span class="token operator">&lt;</span>your-pod-name<span class="token operator">&gt;</span>  -n <span class="token operator">&lt;</span>your-namespace<span class="token operator">&gt;</span>  -- /bin/sh
</code></pre></div><h2 id="查询pod的yaml文件"><a href="#查询pod的yaml文件" class="header-anchor">#</a> 查询Pod的yaml文件</h2> <div class="language-bash extra-class"><pre class="language-bash"><code>kubectl get pod <span class="token punctuation">{</span>podname<span class="token punctuation">}</span> -n <span class="token punctuation">{</span>naemspace<span class="token punctuation">}</span> -o yaml <span class="token operator">&gt;</span> <span class="token punctuation">{</span>文件名<span class="token punctuation">}</span>.yml
</code></pre></div><h2 id="k8s-证书过期更新"><a href="#k8s-证书过期更新" class="header-anchor">#</a> k8s 证书过期更新</h2> <div class="language-shell extra-class"><pre class="language-shell"><code>kubeadm alpha certs renew all
</code></pre></div></div></article> <section class="post-meta main-div" data-v-4e23451f><section class="post-date clearfix" data-v-4e23451f><span class="create-date" data-v-4e23451f>
      发布时间 : 2023-02-13
    </span> <span class="update-date" data-v-4e23451f>
      最后修改 : 2024-12-12
    </span></section> <section class="post-links" data-v-4e23451f><a href="/post-ci/posts/2023/02/13/kubernetes%E9%83%A8%E7%BD%B2.html" class="post-link" data-v-4e23451f>
      上一篇 : Kubernetes部署
    </a> <a href="/post-ci/posts/2023/02/13/kubernetes-yaml.html" class="post-link" data-v-4e23451f>
      下一篇 : Kubernetes YAML详解
    </a></section></section> <div id="post-comments" class="main-div"><!----></div></div></main> <aside class="aside" data-v-4dd605a1><div class="info-card main-div" data-v-9d847660 data-v-4dd605a1><div class="info-card-header" style="background-size:cover;background-repeat:no-repeat;background-position:center;background-attachment:scroll;background-image:url(/img/wx-background.jpg);" data-v-9d847660><img src="/img/cm.jpg" alt="小二哥" class="info-avatar" data-v-9d847660></div> <div class="info-card-body" data-v-9d847660><section class="info-nickname" data-v-9d847660>
      小二哥
    </section> <section class="info-desc" data-v-9d847660>Don`t Worry Be Happy!</section> <section class="info-contact" data-v-9d847660><section data-v-9d847660><span title="DaLian City, China" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>DaLian City, China</title><use xlink:href="#icon-location" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          DaLian City, China
        </span></span></section> <section data-v-9d847660><span title="DaLian University of Technology" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>DaLian University of Technology</title><use xlink:href="#icon-organization" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          DaLian University of Technology
        </span></span></section> <section data-v-9d847660><a href="mailto:csrsming@163.com" title="csrsming@163.com" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>csrsming@163.com</title><use xlink:href="#icon-email" data-v-9d847660 data-v-9d847660></use></svg><span class="info-text" data-v-9d847660 data-v-9d847660>
          csrsming@163.com
        </span></a></section></section></div> <div class="info-card-footer" data-v-9d847660><section class="info-sns clearfix" data-v-9d847660><a href="https://github.com/csrsm" target="_blank" class="sns-link" data-v-9d847660><span title="GitHub: csrsm" class="sns-icon" data-v-9d847660 data-v-9d847660><svg class="icon" style="font-size:1.5em;" data-v-9d847660 data-v-9d847660><title data-v-9d847660 data-v-9d847660>GitHub: csrsm</title><use xlink:href="#icon-github" data-v-9d847660 data-v-9d847660></use></svg></span></a></section></div></div> <div class="post-nav-card main-div" style="position:relative;top:0;width:0px;" data-v-4dd605a1><div class="post-nav-contents"><svg class="icon"><title>book</title><use xlink:href="#icon-book"></use></svg> <span>文章目录</span> <div class="post-nav-toc"><ul><li><a href="/post-ci/posts/2023/02/13/kubernetes%E5%91%BD%E4%BB%A4.html#pod命令">pod命令</a></li><li><a href="/post-ci/posts/2023/02/13/kubernetes%E5%91%BD%E4%BB%A4.html#label命令">label命令</a></li><li><a href="/post-ci/posts/2023/02/13/kubernetes%E5%91%BD%E4%BB%A4.html#node命令">node命令</a></li><li><a href="/post-ci/posts/2023/02/13/kubernetes%E5%91%BD%E4%BB%A4.html#describe命令">describe命令</a></li><li><a href="/post-ci/posts/2023/02/13/kubernetes%E5%91%BD%E4%BB%A4.html#taint命令">taint命令</a></li><li><a href="/post-ci/posts/2023/02/13/kubernetes%E5%91%BD%E4%BB%A4.html#controller命令">controller命令</a><ul><li><a href="/post-ci/posts/2023/02/13/kubernetes%E5%91%BD%E4%BB%A4.html#deployment">deployment</a></li></ul></li><li><a href="/post-ci/posts/2023/02/13/kubernetes%E5%91%BD%E4%BB%A4.html#service命令">Service命令</a></li><li><a href="/post-ci/posts/2023/02/13/kubernetes%E5%91%BD%E4%BB%A4.html#pod启动调试">Pod启动调试</a></li><li><a href="/post-ci/posts/2023/02/13/kubernetes%E5%91%BD%E4%BB%A4.html#secret命令">Secret命令</a></li><li><a href="/post-ci/posts/2023/02/13/kubernetes%E5%91%BD%E4%BB%A4.html#configmap命令">ConfigMap命令</a></li><li><a href="/post-ci/posts/2023/02/13/kubernetes%E5%91%BD%E4%BB%A4.html#namespace命令">namespace命令</a></li><li><a href="/post-ci/posts/2023/02/13/kubernetes%E5%91%BD%E4%BB%A4.html#万能重启pod命令">万能重启Pod命令</a></li><li><a href="/post-ci/posts/2023/02/13/kubernetes%E5%91%BD%E4%BB%A4.html#进入pod">进入pod</a></li><li><a href="/post-ci/posts/2023/02/13/kubernetes%E5%91%BD%E4%BB%A4.html#查询pod的yaml文件">查询Pod的yaml文件</a></li><li><a href="/post-ci/posts/2023/02/13/kubernetes%E5%91%BD%E4%BB%A4.html#k8s-证书过期更新">k8s 证书过期更新</a></li></ul></div></div> <div class="post-nav-comments"><svg class="icon"><title>comment</title><use xlink:href="#icon-comment"></use></svg> <a href="/post-ci/posts/2023/02/13/kubernetes%E5%91%BD%E4%BB%A4.html#post-comments">
      评论
    </a></div></div></aside></div> <footer class="footer" data-v-1375e54c><p class="footer-sns-links" data-v-1375e54c><a href="https://github.com/csrsm" target="_blank" class="sns-link" data-v-1375e54c><span title="GitHub: csrsm" class="sns-icon" data-v-1375e54c data-v-1375e54c><svg class="icon" style="font-size:25px;" data-v-1375e54c data-v-1375e54c><title data-v-1375e54c data-v-1375e54c>GitHub: csrsm</title><use xlink:href="#icon-github" data-v-1375e54c data-v-1375e54c></use></svg></span></a></p> <!----> <p class="footer-text" data-v-1375e54c>Copyright 2016-present <a href="https://github.com/csrsm" target="_blank">csrsm</a></p></footer></div><div class="global-ui"><!----><!----></div></div>
    <script src="/post-ci/assets/js/app.f434079f.js" defer></script><script src="/post-ci/assets/js/7.8eaaf042.js" defer></script><script src="/post-ci/assets/js/22.3329f709.js" defer></script>
  </body>
</html>
